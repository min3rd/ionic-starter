<ion-header>
    <ion-toolbar>
        <ion-buttons slot="start">
            <ion-back-button></ion-back-button>
        </ion-buttons>
        @if (course) {
        <ion-title>
            {{course.title | transloco | capitalize}}
        </ion-title>
        }
        <ion-buttons slot="end">
            <ion-button>
                <ion-icon name="ellipsis-vertical" slot="icon-only"></ion-icon>
            </ion-button>
        </ion-buttons>
    </ion-toolbar>
</ion-header>
<ion-content class="ion-padding">
    <div [innerHTML]="steps[course.progress?.currentStep ?? 0].content">
    </div>
</ion-content>
<ion-footer id="main-content">
    <ion-progress-bar [value]="((course.progress?.currentStep ?? 0) / (course.totalSteps ?? 1))"></ion-progress-bar>
    <ion-toolbar>
        <ion-buttons slot="start">
            <ion-menu-button></ion-menu-button>
        </ion-buttons>
        <ion-label>
            {{course.progress?.currentStep ?? 0}}/{{course.totalSteps ?? 1}}
        </ion-label>
        <ion-buttons slot="end">
            <ion-button (click)="read(-1)">
                <ion-icon name="arrow-back" slot="icon-only"></ion-icon>
            </ion-button>
            <ion-button (click)="read(1)">
                <ion-icon name="arrow-forward" slot="icon-only"></ion-icon>
            </ion-button>
        </ion-buttons>
    </ion-toolbar>
</ion-footer>

<ion-menu type="overlay" contentId="main-content">
    <ion-header>
        <ion-toolbar>
            <ion-buttons slot="start">
                <ion-button [routerLink]="['../']" routerDirection="backward">
                    <div class="flex items-center gap-2">
                        <ion-icon name="arrow-back"></ion-icon>
                        <ion-label>
                            {{'back to courses' | transloco | capitalize}}
                        </ion-label>
                    </div>
                </ion-button>
            </ion-buttons>
        </ion-toolbar>
    </ion-header>
    <ion-content class="ion-padding">
        <div class="flex flex-col">
            @if (course.category) {
            <div>
                <ion-chip>
                    {{course.category | transloco | capitalize}}
                </ion-chip>
            </div>
            }
            @if (course.title) {
            <div class="text-xl font-semibold truncate mt-4">
                {{course.title | transloco | capitalize}}
            </div>
            }
            @if (course.description) {
            <div class="text-sm font-light line-clamp-3 mt-2">
                {{course.description | transloco | capitalize}}
            </div>
            }
            @if (course.duration) {
            <div class="flex items-center gap-2 text-sm font-light">
                <ion-icon name="time"></ion-icon>
                <span>
                    {{course.duration}} {{'minutes' | transloco}}
                </span>
            </div>
            }
        </div>
        @if (steps && steps.length > 0) {
        <div class="flex flex-col gap-4 py-4">
            @for (step of steps; track $index) {
            <div class="flex items-center border-b">
                <div class="flex flex-col"
                    [ngClass]="{'line-through text-slate-400': (step.order??0) < (course.progress?.currentStep??0)}">
                    <div>
                        {{step.title | transloco | capitalize}}
                    </div>
                    <div class="text-sm">
                        {{step.subtitle| transloco | capitalize}}
                    </div>
                </div>
                <ion-button fill="clear" shape="round">
                    <ion-icon name="arrow-forward" slot="icon-only"></ion-icon>
                </ion-button>
            </div>
            }
        </div>
        }
    </ion-content>
</ion-menu>